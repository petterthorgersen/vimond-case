<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Multiple Language Timed Text Sample</title>
    <meta name="description" content="" />

    <link rel="stylesheet" href="contrib/akamai/controlbar/controlbar.css">
    <script src="contrib/akamai/controlbar/ControlBar.js"></script>
    <script src="dist/dash.all.debug.js"></script>

    <script>
        var EXTERNAL_CAPTION_URL = "http://dash.edgesuite.net/dash264/TestCases/4b/qualcomm/1/ED_OnDemand_5SecSeg_Subtitles.mpd", // need to manually seek to get stream to start... issue with MPD but only sample with multi adaptations for external sidecar caption text xml
            FRAGMENTED_CAPTION_URL = "http://vm2.dashif.org/dash/vod/testpic_2s/multi_subs.mpd",
            MULTI_PERIOD_1= "http://dash.edgesuite.net/dash264/TestCases/5a/1/manifest.mpd",
            MULTI_PERIOD_2='http://media.axprod.net/TestVectors/v6-Clear/MultiPeriod_Manifest_1080p.mpd',
            MULTI_PERIOD_XLink='http://dash.edgesuite.net/fokus/adinsertion-samples/xlink/twoperiods.mpd',
            MULTI_PERIOD_LIVE='http://vm2.dashif.org/livesim-dev/periods_60/continuous_1/testpic_2s/Manifest.mpd',
            MULTI_PERIOD_LIVE_2=' http://vm2.dashif.org/livesim/periods_60/testpic_2s/Manifest.mpd',
            LIVE_TEMPLATE='http://vm2.dashif.org/livesim/testpic_2s/Manifest.mpd',
            LIVE_TIMELINE='http://vm2.dashif.org/livesim-dev/segtimeline_1/testpic_2s/Manifest.mpd',
            VOD_TEMPLATE='http://rdmedia.bbc.co.uk/dash/ondemand/testcard/1/client_manifest-events.mpd',
            VOD_TIMELINE='http://demo.unified-streaming.com/video/ateam/ateam.ism/ateam.mpd',
            VOD_BASE='http://dash.edgesuite.net/dash264/TestCases/1a/sony/SNE_DASH_SD_CASE1A_REVISED.mpd',
            NON_ZERO_PST ='http://dash.edgesuite.net/dash264/TestCases/1a/sony/SNE_DASH_SD_CASE1A_REVISED.mpd',
            ISSUE_STREAM_SAFARI ='https://living.video/MPD/test8.mpd',
            MULTI_LANG_TRACKS = "http://s3-eu-west-1.amazonaws.com/smp-scratch/multilang/manifest.mpd",
            controlbar,
            player,
            url = "http://vm2.dashif.org/dash/vod/testpic_2s/cea608_and_segs.mpd"
                    //"http://cdn1-live.mlflux.net/public/seb/seb.isml/seb.mpd"//LIVE_TEMPLATE

        function startVideo() {


            player = dashjs.MediaPlayer().create();


            //player.setLiveDelayFragmentCount(2);
            //player.setBufferPruningInterval(600);


            player.initialize(document.getElementById("video"), null, true);
            player.attachTTMLRenderingDiv(document.getElementById("ttml-rendering-div"));
            player.attachSource(url);


            controlbar = new ControlBar(player, false);
            controlbar.initialize();

            setInterval(function() {
                document.getElementById("buffer-level").innerHTML = "Buffer: " + player.getBufferLength();
            }, 500);


            //player.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_START, onQualityChangeStart)
            //player.setProtectionData(prodData);
            //player.setMaxAllowedBitrateFor('video', 800);
            //player.enableBufferOccupancyABR(true);
            //player.setAutoSwitchQualityFor("video", false);
            //player.setAutoSwitchQualityFor("audio", false);
            //player.setFastSwitchEnabled(true);
            //player.setAutoSwitchQualityFor("video", false);
            //player.setFragmentLoaderRetryAttempts(10)
            //player.useSuggestedPresentationDelay(false);
            //player.setScheduleWhilePaused(true);
            //player.setAutoSwitchQuality(false);
            //player.setLiveDelayFragmentCount(0);
            //player.setScheduleWhilePaused(true);
            //player.enableManifestDateHeaderTimeSource(false)
        }

        function reload() {
            player.attachSource(url);
        }


        //var prodData = {
        //            "com.widevine.alpha": {
        //                "drmtoday": true,
        //                "serverURL": "https://lic.staging.drmtoday.com/license-proxy-widevine/cenc/",
        //                "httpRequestHeaders": {
        //                    "x-dt-auth-token": "eyJhbGciOiJIUzUxMiJ9.eyJjcnQiOiJbe1wiYWNjb3VudGluZ0lkXCI6XCIxXCIsXCJhc3NldElkXCI6XCJjZjI5YWE4YjcxNTgzZDE4Mzk3MmE2Yjk4ZDcxNTkxNlwiLFwicHJvZmlsZVwiOntcInB1cmNoYXNlXCI6e319LFwib3V0cHV0UHJvdGVjdGlvblwiOntcImRpZ2l0YWxcIjpmYWxzZSxcImFuYWxvZ3VlXCI6ZmFsc2UsXCJlbmZvcmNlXCI6ZmFsc2V9fV0iLCJvcHREYXRhIjoie1widXNlcklkXCI6XCJwdXJjaGFzZVwiLFwibWVyY2hhbnRcIjpcImRpZ2l0YWxmaWxtdHJlZVwiLFwic2Vzc2lvbklkXCI6XCI0ODQ3MDE4ZTY5ZTNiM2RkOGFlNDdmM2NiZTgxMWU3ZFwifSIsImlhdCI6MTQ2OTY0NTM5NywianRpIjoiK2k3bG1ud1VHckE0RlFQa3BrN1wvR1E9PSJ9.Z8V1Cgy1t-FwbP8uYc8KNQyRqDzU7W0d4lRXUE9j2c9v8Gj-YnBPOLW3aXYwLQBasIl900Cr3Y1hCr0dlev1sQ"
        //                }
        //            },
        //            "com.microsoft.playready": {
        //                "drmtoday": true,
        //                "serverURL": "https://lic.staging.drmtoday.com/license-proxy-headerauth/drmtoday/RightsManager.asmx",
        //                "httpRequestHeaders": {
        //                    "x-dt-auth-token": "eyJhbGciOiJIUzUxMiJ9.eyJjcnQiOiJbe1wiYWNjb3VudGluZ0lkXCI6XCIxXCIsXCJhc3NldElkXCI6XCJjZjI5YWE4YjcxNTgzZDE4Mzk3MmE2Yjk4ZDcxNTkxNlwiLFwicHJvZmlsZVwiOntcInB1cmNoYXNlXCI6e319LFwib3V0cHV0UHJvdGVjdGlvblwiOntcImRpZ2l0YWxcIjpmYWxzZSxcImFuYWxvZ3VlXCI6ZmFsc2UsXCJlbmZvcmNlXCI6ZmFsc2V9fV0iLCJvcHREYXRhIjoie1widXNlcklkXCI6XCJwdXJjaGFzZVwiLFwibWVyY2hhbnRcIjpcImRpZ2l0YWxmaWxtdHJlZVwiLFwic2Vzc2lvbklkXCI6XCI3NzU0ODlhNGVkN2Q5Nzk5MDEzNWJmZWQ2ODQ1NTNkZFwifSIsImlhdCI6MTQ2OTY0NTYxNiwianRpIjoiWHVMMkFFZWdVOFwvdTlZUVBVbkVZN3c9PSJ9.cdw9RT4_aZMPhiLSRNUQ4OTtx_Lw4GEFDquemkylpQzxCNwSswJ0kXvGm40rA8Fz334v1Bd6pXDwJ3fmgfMvoQ"
        //                }
        //            }
        //        }


        //        var prodData = {
        //            "com.widevine.alpha": {
        //                "drmtoday": true,
        //                "serverURL": "https://lic.staging.drmtoday.com/license-proxy-widevine/cenc/",
        //                "httpRequestHeaders": {
        //                    "dt-custom-data": "eyJ1c2VySWQiOiIxMjM0NSIsInNlc3Npb25JZCI6ImV3b2dJQ0p3Y205bWFXeGxJaUE2SUhzS0lDQWdJQ0p3ZFhKamFHRnpaU0lnT2lCN0lIMEtJQ0I5TEFvZ0lDSnZkWFJ3ZFhSUWNtOTBaV04wYVc5dUlpQTZJSHNLSUNBZ0lDSmthV2RwZEdGc0lpQTZJR1poYkhObExBb2dJQ0FnSW1GdVlXeHZaM1ZsSWlBNklHWmhiSE5sTEFvZ0lDQWdJbVZ1Wm05eVkyVWlJRG9nWm1Gc2MyVUtJQ0I5TEFvZ0lDSnpkRzl5WlV4cFkyVnVjMlVpSURvZ1ptRnNjMlVLZlFvSyIsIm1lcmNoYW50IjoiY2FibGVsYWJzIn0K"
        //                }
        //            },
        //            "com.microsoft.playready": {
        //                "drmtoday": true,
        //                "serverURL": "https://lic.staging.drmtoday.com/license-proxy-headerauth/drmtoday/RightsManager.asmx",
        //                "httpRequestHeaders": {
        //                    "http-header-CustomData": "eyJ1c2VySWQiOiIxMjM0NSIsInNlc3Npb25JZCI6ImV3b2dJQ0p3Y205bWFXeGxJaUE2SUhzS0lDQWdJQ0p3ZFhKamFHRnpaU0lnT2lCN0lIMEtJQ0I5TEFvZ0lDSnZkWFJ3ZFhSUWNtOTBaV04wYVc5dUlpQTZJSHNLSUNBZ0lDSmthV2RwZEdGc0lpQTZJR1poYkhObExBb2dJQ0FnSW1GdVlXeHZaM1ZsSWlBNklHWmhiSE5sTEFvZ0lDQWdJbVZ1Wm05eVkyVWlJRG9nWm1Gc2MyVUtJQ0I5TEFvZ0lDSnpkRzl5WlV4cFkyVnVjMlVpSURvZ1ptRnNjMlVLZlFvSyIsIm1lcmNoYW50IjoiY2FibGVsYWJzIn0K"
        //                }
        //            }
        //        }

    </script>

    <style>

        video {
            width: 960px;
            height: 540px;
        }

        .videoContainer {
            width: 960px;
        }
    </style>

    <body onload="startVideo()" style="background-color:#000000">
        <button onclick="reload()" id="down-switch">Load</button>
        <label id="buffer-level" style="color: #FFFFFF"></label>
        <div class="videoContainer">
            <video id="video"> </video>
            <div id="ttml-rendering-div"></div>
            <div id="videoController" class="video-controller unselectable">
                <div id="playPauseBtn" class="btn-play-pause" data-toggle="tooltip" data-placement="bottom" title="Play/Pause">
                    <span id="iconPlayPause" class="icon-play"></span>
                </div>
                <span id="videoTime" class="time-display">00:00:00</span>
                <div id="fullscreenBtn" class="btn-fullscreen control-icon-layout" data-toggle="tooltip" data-placement="bottom" title="Fullscreen">
                    <span class="icon-fullscreen-enter"></span>
                </div>
                <div id="bitrateListBtn" class="btn-bitrate control-icon-layout" data-toggle="tooltip" data-placement="bottom" title="Bitrate List">
                    <span class="icon-bitrate"></span>
                </div>
                <input type="range" id="volumebar" class="volumebar" value="1" min="0" max="1" step=".01"/>
                <div id="muteBtn" class="btn-mute control-icon-layout" data-toggle="tooltip" data-placement="bottom" title="Mute">
                    <span id="iconMute" class="icon-mute-off"></span>
                </div>
                <div id="trackSwitchBtn" class="btn-track-switch control-icon-layout" data-toggle="tooltip" data-placement="bottom" title="Track List">
                    <span class="icon-tracks"></span>
                </div>
                <div id="captionBtn" class="btn-caption control-icon-layout" data-toggle="tooltip" data-placement="bottom" title="Closed Caption / Subtitles">
                    <span class="icon-caption"></span>
                </div>
                <span id="videoDuration" class="duration-display">00:00:00</span>
                <div class="seekContainer">
                    <input type="range" id="seekbar" value="0" class="seekbar" min="0" step="0.01"/>
                </div>
            </div>
        </div>
    </body>
</html>


